(function(){"use strict";const i="https://collect.babbel.com/v1/events",r="[Martech eventsCollector]";async function c(t){const o=Array.isArray(t)?t:[t];try{const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o),keepalive:!0,credentials:"include"});if(!e.ok){const n=new Error(`HTTP ${e.status}: ${e.statusText}`);console.error(`${r} HTTP Error:`,n),window.webTools?.rollbar.error(n)}}catch(e){console.error(`${r} Failed:`,e),window.webTools?.rollbar.error(e)}}const l=t=>{const o=async()=>{if(document.visibilityState==="visible")try{await t()}catch(e){window.webTools?.rollbar.error(e)}};document.visibilityState==="visible"&&o(),document.addEventListener("visibilitychange",o)},a=()=>localStorage.getItem("ignoreEventsCollector")==="true";(()=>{if(a()){console.info("[Martech eventsCollector] ignored: due to localStorage ignoreEventsCollector setting");return}l(()=>c({n:"page:viewed",dl:window.location.href,dr:document.referrer||null,dt:document.title||null,timestamp:Date.now()}))})()})();
